<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('../partials/head.ejs') %>
  <link rel="stylesheet" href="/css/styles_register.css">
  <title>Perfil de usuario</title>
</head>

<body>
  <header>
    <%- include('../partials/header.ejs') %>
  </header>
  <main>
    <section class="vh-100"
      style="background: url('https://www.unidiversidad.com.ar/cache/recitales-cultura_1000_1100.jpg')">
      <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
          <div class="col col-lg-9 mb-4 mb-lg-0">
            <div class="card mb-3" style="border-radius: .5rem; ">
              <div class="row g-0">
                <div class="col-md-4 gradient-custom text-center text-white"
                  style="border-top-left-radius: .5rem; border-bottom-left-radius: .5rem;">

                  <% if (locals.usuario.imageProfile  == "404.jpg") { %>
                  <img src="../../images/users/avatar.png" alt="Avatar" class="img-fluid my-5"
                    style="width: 150px; border-radius: 40%;" />
                  <% } else { %>
                  <img src="../../images/users/<%= locals.usuario.imageProfile %>" alt="Avatar" class="img-fluid my-5"
                    style="width: 150px; border-radius: 40%;" />
                  <% } %>

                  </br>
                  <% if (locals.usuario) { %>
                  <% if (locals.usuario.roles_id == 1) { %>
                  <a href="/createProfile">
                    <button type="button" class="btn btn-warning">
                      Crear usuario
                    </button>
                  </a>
                  <% } %>
                  <% } %>

                  </br>
                  </br>
                  <% if (locals.usuario) { %>
                  <% if (locals.usuario.roles_id == 1) { %>
                  <a href="/profile">
                    <button type="button" class="btn btn-warning">
                      Cancelar
                    </button>
                  </a>
                  <% } %>
                  <% } %>
                  </br>
                  </br>
                </div>
                <div class="col-md-8">
                    <hr class="mt-0 mb-4">
                    <div class="table-responsive">
                      <table id="users_table" class="table">
                        <thead>
                          <tr>
                            <th scope="col">Usuario</th>
                            <th scope="col">Nombre usuario</th>
                            <th scope="col">Categoria</th>
                            <th scope="col">Editar</th>
                          </tr>
                        </thead>
                        <tbody>
                          <% usersList.forEach(user => { %>
                          <tr>
                            <td>
                                <% if (user.imageProfile == "404.jpg") { %>
                                  <!--no profile img -->
                                  <img src="../../images/users/avatar.png" alt="Avatar" width="50" height="50"/>
                                <% } else { %>
                                  <!--user logged , with profile img -->
                                  <img src="../../images/users/<%= user.imageProfile %>" style=" width:60px;  height:60px;  border-radius:100px"/>
                                <% } %>
                            </td>
                            <td><%- user.userName %></td>
                            <td><%- user.roles_id == 1 ? "Administrador" : "Cliente" %></td>
                            <td> 
                              <a href="/editProfile/<%- user.id %>">
                                <button type="button" class="btn btn-outline-dark">
                                  Editar
                                </button>
                              </a>  
                            </td>
                          </tr>
                          <% }); %>
                        </tbody>
                      </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <%- include('../partials/footer.ejs') %>
  </footer>

</body>

</html>